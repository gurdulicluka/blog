---
import { Icon } from "astro-icon";
interface Props {
  title: String;
}
const url = Astro.site!.origin + Astro.url.pathname;
const { title } = Astro.props as Props;
---

<ul class="flex items-center gap-1 [&>li]:h-[26px]">
  <li>
    <a
      href=`http://www.facebook.com/sharer.php?u=${url}`
      class="btn btn-ghost btn-sm btn-square"
      target="_blank"
      aria-label="Share blog post on Facebook"
    >
      <Icon
        pack="mdi"
        name="facebook"
        height="26"
        class="[&>path]:fill-base-content/60"
      />
    </a>
  </li>
  <li>
    <a
      href=`http://twitter.com/share?url=${url}&text=${title}`
      class="btn btn-ghost btn-sm btn-square"
      target="_blank"
      aria-label="Share blog post on Twitter"
    >
      <Icon
        pack="mdi"
        name="twitter"
        height="26"
        class="[&>path]:fill-base-content/60"
      />
    </a>
  </li>
  <li>
    <a
      href=`http://www.linkedin.com/shareArticle?mini=true&url=${url}`
      class="btn btn-ghost btn-sm btn-square"
      target="_blank"
      aria-label="Share blog post on LinkedIn"
    >
      <Icon
        pack="mdi"
        name="linkedin"
        height="26"
        class="[&>path]:fill-base-content/60"
      />
    </a>
  </li>
  <li>
    <a
      href=`http://reddit.com/submit?url=${url}&title=${title}`
      class="btn btn-ghost btn-sm btn-square"
      target="_blank"
      aria-label="Share blog post on Reddit"
    >
      <Icon
        pack="mdi"
        name="reddit"
        height="26"
        class="[&>path]:fill-base-content/60"
      />
    </a>
  </li>
  <li x-data="clipboard">
    <!-- COPY TO CLIPBOARD BUTTON -->
    <button
      id="copyUrlBtn"
      @click="copyToClipboard"
      aria-label="Copy URL to clipboard"
      :disabled="showToast"
      value={url.toString()}
      class="btn btn-ghost btn-sm btn-square overflow-hidden relative"
    >
      <Icon
        pack="mdi"
        name="link-variant"
        height="26"
        class="[&>path]:fill-base-content/60"
        x-show="!showToast"
      />
      <Icon
        x-cloak
        pack="mdi"
        name="link-variant-plus"
        height="26"
        class="[&>path]:fill-info absolute animate__animated"
        x-transition:enter="animate__fadeIn"
        x-transition:leave="animate__fadeOut"
        x-show="showToast"
      />
    </button>
    <!-- TOAST -->
    <template x-teleport="#overlays">
      <div
        role="alert"
        x-cloak
        x-transition:enter="animate__fadeIn"
        x-transition:leave="animate__bounceOutDown"
        x-show="showToast"
        class="toast toast-start animate__animated z-50"
      >
        <div class="alert alert-info font-medium">
          <div>
            Link copied to clipboard
            <Icon pack="mdi" name="clipboard-check-outline" height="24" />
          </div>
        </div>
      </div>
    </template>
  </li>
</ul>

<script>
  import Alpine from "alpinejs";
  import copy from "copy-to-clipboard";

  document.addEventListener("alpine:init", () => {
    Alpine.data("clipboard", () => ({
      showToast: false,
      copyToClipboard(event) {
        copy(event.target.value);
        this.showToast = true;
        setTimeout(() => {
          this.showToast = false;
        }, 1800);
      },
    }));
  });
</script>
