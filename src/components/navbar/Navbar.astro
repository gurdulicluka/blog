---
import ThemeSwitchBtn from "./ThemeSwitchBtn.astro";
import Logo from "./Logo.astro";
import SlidingMenu from "./SlidingMenu.astro";
import SearchBar from "../search/SearchBar.astro";
import Dropdown from "../navbar/Dropdown.astro";
import { Icon } from "astro-icon";
---

<header
  x-data="navbar"
  x-show="showNavbar"
  @scroll.window="handleVisibility"
  x-transition:enter="animate__slideInDown"
  x-transition:leave="animate__slideOutUp"
  class="border-b border-base-200/30 shadow-md animate__animated bg-base-300 fixed min-h-16 top-0 w-full z-50">
  <div class="2xl:container navbar justify-between">
    <div class="navbar-start hidden md:flex gap-2 [&>a]:capitalize">
      <a href="/" class="btn btn-ghost">Home</a>
      <Dropdown />
      <a href="/contact" class="btn btn-ghost">Contact</a>
    </div>
    <div class="navbar-center">
      <Logo />
    </div>
    <div class="navbar-end hidden md:flex items-center gap-3">
      <SearchBar />
      <ThemeSwitchBtn />
    </div>
    <SlidingMenu />
  </div>
</header>

<script>
  import Alpine from "alpinejs";
  // Hide on scroll down, show on scroll up
  let prevScrollPos = window.scrollY;
  document.addEventListener("alpine:init", () => {
    Alpine.data("navbar", () => ({
      showNavbar: true,
      handleVisibility() {
        const currentScrollPos = window.scrollY;

        if (prevScrollPos > currentScrollPos || currentScrollPos < 500) {
          this.showNavbar = true;
        } else {
          this.showNavbar = false;
        }

        prevScrollPos = currentScrollPos;
      },
    }));
  });
</script>
