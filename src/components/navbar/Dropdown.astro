---
import { getCollection } from "astro:content";
import { slugify } from "@js/utils";
import { Icon } from "astro-icon";

const allPosts = await getCollection("blog");
const uniqueCategories = [
  ...new Set(
    allPosts.map((post) => {
      return post.data.category;
    })
  ),
];
---

<div class="dropdown">
  <label tabindex="0" class="btn btn-ghost capitalize">
    <span>Blog</span>
    <span class="inline-block -mr-3 -ml-1">
      <Icon name="mdi:chevron-down" height="22" />
    </span>
  </label>
  <div
    tabindex="0"
    class="menu dropdown-content shadow-xl translate-y-2 z-50 rounded-lg bg-base-200 border-2 border-accent w-52">
    <a href="/blog" class="btn btn-ghost btn-active hover:bg-accent capitalize"
      >All Posts</a
    >
    <ul class="menu menu-md">
      <li class="menu-title">View by Category</li>
      {
        uniqueCategories.map((category) => (
          <li>
            <a class="font-medium" href={`/category/${slugify(category)}`}>
              {category}
            </a>
          </li>
        ))
      }
    </ul>
  </div>
</div>
