---
const email = import.meta.env.FORM_SUBMIT_EMAIL; // Netlify .env
---

<form
  x-data
  action={`https://formsubmit.co/${email}`}
  class="my-8"
  method="POST"
>
  <input type="hidden" name="_template" value="box" />
  <input type="hidden" name="_subject" value="Kodahead Contact" />
  <input type="hidden" name="_next" value={Astro.site?.toString()} />
  <div class="flex flex-col sm:flex-row w-full gap-4">
    <div class="flex flex-col flex-1">
      <label for="name" class="mb-1 text-lg font-medium">Name:</label>
      <input
        id="name"
        name="name"
        type="text"
        class="input bg-base-200 input-bordered focus:outline-info"
        placeholder="Full Name"
        spellcheck="false"
        required
        aria-required="true"
      />
    </div>

    <div class="flex flex-col flex-1">
      <label for="email" class="mb-1 text-lg font-medium">Email:</label>
      <input
        id="email"
        name="email"
        type="email"
        class="input bg-base-200 input-bordered focus:outline-info"
        placeholder="Email Address"
        spellcheck="false"
        required
        aria-required="true"
      />
    </div>
  </div>

  <div x-data="{message:'', remaining: 300 }" class="flex flex-col my-6">
    <label for="message" class="mb-1 text-lg font-medium">Message:</label>
    <textarea
      x-model="message"
      @input="remaining= 300 - message.length"
      id="message"
      name="message"
      class="resize-y bg-base-200 textarea text-base min-h-[15em] max-h-[800px] textarea-bordered w-full focus:outline-info placeholder:text-base"
      placeholder="Your Message"
      autocomplete="off"
      spellcheck="false"
      maxlength="300"
      required
      aria-required="true"></textarea>
    <!-- Characters remaining -->
    <div class="flex justify-start mt-3 items-center text-sm font-semibold">
      <span
        x-text="remaining"
        :class="{'text-error animate__flash': remaining <= 0, 'text-warning animate__headShake': remaining > 0 && remaining <= 50, 'text-success': remaining > 50}"
        class="animate__animated"></span>
      <span x-show="remaining <= 0" class="font-normal text-xs ml-2 text-error"
        >You've reached the maximum character limit.</span
      >
    </div>
  </div>
  <div class="flex sm:justify-end">
    <button class="btn w-full md:w-fit btn-primary capitalize" type="submit"
      >Send message</button
    >
  </div>
</form>
